(function($){var MILLIS_IN_DAY=86400000;var MILLIS_IN_HOUR=3600000;var MILLIS_IN_MINUTE=60000;var MILLIS_IN_SECOND=1000;var SECONDS_IN_DAY=86400;var SECONDS_IN_HOUR=3600;var SECONDS_IN_MINUTE=60;var MINUTES_IN_DAY=SECONDS_IN_DAY/60;var MINUTES_IN_HOUR=60;var HOURS_IN_DAY=24;var MONTHS_IN_YEAR=12;var MIN_SUSPEND_THRESHOLD=50;var SUSPEND_THRESHOLD_RELAX_STEP=100;var SUSPEND_THRESHOLD_RESTRICT_STEP=50;var WINDOW_RESIZE_EVENT_DELAY=500;var SCD_SAFE_ADJUST_PX=10;scds_container={timer:{id:!1,now:!1,offset:!1,awake_detect:!1,suspend_threshold:MIN_SUSPEND_THRESHOLD,acc_correction:0},instances:{},add:function(options){var working_copy=$.extend(!0,{},scd_counter);working_copy.init(options);if(this.timer.id===!1){this.timer.id=window.setTimeout(function(){scds_container.fireAllCounters()},MILLIS_IN_SECOND);$(window).resize(function(){clearTimeout($.data(this,'resizeTimer'));$.data(this,'resizeTimer',setTimeout(function(){scds_container.responsiveAdjust()},WINDOW_RESIZE_EVENT_DELAY))});this.setupVelocityEasings()}},remove:function(id){delete(scds_container.instances[id])},updateInstance:function(id,instance){scds_container.instances[id]=instance;scds_container.responsiveAdjust()},fireAllCounters:function(){var now=new Date().getTime();if(this.timer.awake_detect===!1){this.timer.awake_detect=now-MILLIS_IN_SECOND}
var elapsed=now-this.timer.awake_detect;this.timer.awake_detect=now;var bias=elapsed-MILLIS_IN_SECOND,timeout=MILLIS_IN_SECOND;if(Math.abs(bias)<20){timeout=MILLIS_IN_SECOND-bias;this.timer.acc_correction-=bias}
this.timer.id=window.setTimeout(function(){scds_container.fireAllCounters()},timeout)
this.timer.acc_correction+=(elapsed-MILLIS_IN_SECOND);var correction=0;if(this.timer.acc_correction>=this.timer.suspend_threshold){correction=this.timer.acc_correction;this.timer.acc_correction=0;this.timer.suspend_threshold+=SUSPEND_THRESHOLD_RELAX_STEP;this.getServerTime(!0)}else if(this.timer.suspend_threshold>MIN_SUSPEND_THRESHOLD){this.timer.suspend_threshold-=SUSPEND_THRESHOLD_RESTRICT_STEP}
this.timer.now+=MILLIS_IN_SECOND;$.each(this.instances,function(){this.tick(!0,correction)})},setServerTime:function(ts){if(this.timer.offset===!1){this.timer.offset=ts-new Date().getTime();this.timer.now=ts}},getServerTime:function(renew){if(renew){this.timer.now=new Date().getTime()+this.timer.offset}
return this.timer.now},responsiveAdjust:function(){$.each(this.instances,function(id,counter){var width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;counter.responsiveAdjust(width)})},setupVelocityEasings:function(){var VelocityContainer=window.Velocity||$.Velocity;$.extend(VelocityContainer.Easings,{Back:function(p){return p*p*(3*p-2)},Bounce:function(p){var pow2,bounce=4;while(p<((pow2=Math.pow(2,--bounce))-1)/11){}
return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((pow2*3-2)/22-p,2)}});$.each(["Back","Bounce"],function(index,easeInName){var easeIn=VelocityContainer.Easings[easeInName];VelocityContainer.Easings["easeIn"+easeInName]=easeIn;VelocityContainer.Easings["easeOut"+easeInName]=function(p){return 1-easeIn(1-p)};VelocityContainer.Easings["easeInOut"+easeInName]=function(p){return p<0.5?easeIn(p*2)/2:1-easeIn(p*-2+2)/2}})}}
var scd_counter={options:{units:{years:1,months:1,weeks:1,days:1,hours:1,minutes:1,seconds:1},hide_lower_units:[],limits:{seconds:SECONDS_IN_HOUR,minutes:MINUTES_IN_HOUR,hours:HOURS_IN_DAY},paddings:{years:1,months:1,weeks:1,days:2,hours:2,minutes:2,seconds:2},animations:{},labels_vert_align:'middle',initDisplay:!0,allow_all_zeros:0,replace_lowest_zero:1,hide_highest_zeros:0,hide_countup_counter:0,shortcode:0,redirect_url:'',click_url:'',import_config:'',base_font_size:12},current_values:{},elements:{},animation_timers:{},init:function(options){$.extend(!0,this.options,options);this.options.original_title_before_down=this.options.title_before_down;this.options.original_title_before_up=this.options.title_before_up;this.options.original_title_after_down=this.options.title_after_down;this.options.original_title_after_up=this.options.title_after_up;this.options.original_countup_limit=this.options.countup_limit;this.options.original_countdown_limit=this.options.countdown_limit;this.options.original_deadline=this.options.deadline;this.queryNextEvent(!0)},tick:function(from_timer,correction){var delta=this.options.mode=='up'?1:-1;if(typeof correction!=='undefined'&&correction!=0){var diff=this.diff+(correction+MILLIS_IN_SECOND)*delta;if(this.options.mode=='down'&&diff<=0){this.deadlineReached()}else{this.softInitCounter(!0)}
return}
this.applyCounterLimits();if(from_timer){this.diff+=delta*MILLIS_IN_SECOND}
var new_values=$.extend({},this.current_values);new_values.seconds+=delta;if(new_values.seconds>=this.options.limits.seconds){if(new_values.seconds>=SECONDS_IN_DAY){this.softInitCounter();return}
new_values.seconds=0;if(this.options.units.minutes==1){new_values.minutes++;if(new_values.minutes>=this.options.limits.minutes){new_values.minutes=0;if(this.options.units.hours==1){new_values.hours++;if(new_values.hours>=this.options.limits.hours){this.softInitCounter();return}}else{this.softInitCounter();return}}}else if(this.options.units.hours==1){new_values.hours++;if(new_values.hours>=this.options.limits.hours){this.softInitCounter();return}}}
if(new_values.seconds<0){if(this.diff<=0){return this.deadlineReached()}
new_values.seconds=this.options.limits.seconds-1;if(this.options.units.minutes==1){new_values.minutes--;if(new_values.minutes<0){new_values.minutes=this.options.limits.minutes-1;if(this.options.units.hours==1){new_values.hours--;if(new_values.hours<0){this.softInitCounter();return}}else{this.softInitCounter();return}}}else if(this.options.units.hours==1){new_values.hours--;if(new_values.hours<0){this.softInitCounter();return}}else{this.softInitCounter();return}}
this.display(new_values)},softInitCounter:function(resumed){if(resumed){}
this.updateCounter(this.getCounterValues())},deadlineReached:function(){if(this.options.redirect_url!=''){$('#'+this.options.id).hide();window.location=this.options.redirect_url;return}
if(this.options.countdown_query_limit==0){$('#'+this.options.id).hide();this.queryNextEvent();this.options.countup_limit=-1;return}
var new_values=this.getCounterValues();this.applyCounterLimits();this.updateCounter(new_values,!0);this.setCounterUnitsVisibility(new_values)},getCounterValues:function(){var now_ts=scds_container.getServerTime();var t,dateFrom,dateTo;dateFrom=new Date(now_ts);var dateTo=new Date(this.options.deadline);if(isNaN(dateTo.getTime())){dateTo=new Date()}
this.diff=dateTo-dateFrom;if(this.diff<=0){this.options.mode='up';var tmp=dateFrom;dateFrom=dateTo;dateTo=tmp;this.diff=this.diff*-1;if(this.diff<MILLIS_IN_SECOND){this.diff=MILLIS_IN_SECOND}}else{this.options.mode='down'}
var target=dateToObject(dateTo);var now=dateToObject(dateFrom);var yearsDiff=target.year-now.year;var monthsDiff=target.month-now.month;var daysDiff=target.day-now.day;var hoursDiff=target.hours-now.hours;var minutesDiff=target.minutes-now.minutes;var secondsDiff=target.seconds-now.seconds;if(secondsDiff<0){minutesDiff--;secondsDiff+=SECONDS_IN_MINUTE}
if(minutesDiff<0){hoursDiff--;minutesDiff+=MINUTES_IN_HOUR}
if(hoursDiff<0){daysDiff--;hoursDiff+=HOURS_IN_DAY}
if(daysDiff<0){monthsDiff--;var daysInNowMonth=daysInThisMonth(now.year,now.month);var daysInPrevTargetMonth=daysInPrevMonth(target.year,target.month);daysDiff+=(daysInNowMonth>daysInPrevTargetMonth?daysInNowMonth:daysInPrevTargetMonth)}
if(monthsDiff<0){yearsDiff--;monthsDiff+=MONTHS_IN_YEAR}
var timeSpan=(hoursDiff*SECONDS_IN_HOUR+minutesDiff*SECONDS_IN_MINUTE+secondsDiff)*MILLIS_IN_SECOND;var yearsEnd=new Date(Date.UTC(now.year+yearsDiff,now.month-1,now.month==2&&now.day==29&&new Date(now.year+yearsDiff,1,29).getMonth()!=1?28:now.day,now.hours,now.minutes,now.seconds));var yearsSpan=yearsEnd.valueOf()-dateFrom.valueOf();var monthsEnd=new Date(dateTo.valueOf()-daysDiff*MILLIS_IN_DAY-timeSpan);var monthsSpan=monthsEnd.valueOf()-yearsEnd.valueOf();var result={};var restDiff=this.diff;if(this.options.units.years==1||this.options.units.months==1){restDiff=restDiff-yearsSpan}
if(this.options.units.years==1){result.years=yearsDiff}else if(this.options.units.months==1){monthsDiff=monthsDiff+yearsDiff*MONTHS_IN_YEAR}
if(this.options.units.months==1){restDiff=restDiff-monthsSpan;result.months=monthsDiff}else{daysDiff=Math.floor(restDiff/MILLIS_IN_DAY)}
if(this.options.units.weeks==1){var weeksDif=Math.floor(daysDiff/7);daysDiff=daysDiff%7;restDiff=restDiff-weeksDif*7*MILLIS_IN_DAY;result.weeks=weeksDif}
if(this.options.units.days==1){result.days=Math.floor(restDiff/MILLIS_IN_DAY);restDiff=restDiff-daysDiff*MILLIS_IN_DAY}
if(this.options.units.hours==1){result.hours=Math.floor(restDiff/MILLIS_IN_HOUR);restDiff=restDiff-result.hours*MILLIS_IN_HOUR}
if(this.options.units.minutes==1){result.minutes=Math.floor(restDiff/MILLIS_IN_MINUTE);restDiff=restDiff-result.minutes*MILLIS_IN_MINUTE}
result.seconds=Math.floor(restDiff/MILLIS_IN_SECOND);if(this.options.units.minutes==1){this.options.limits.seconds=SECONDS_IN_MINUTE}else{if(this.options.units.hours==1){this.options.limits.seconds=SECONDS_IN_HOUR}else{this.options.limits.seconds=SECONDS_IN_DAY}}
if(this.options.units.hours==1){this.options.limits.minutes=MINUTES_IN_HOUR}else{this.options.limits.minutes=MINUTES_IN_DAY}
for(asset in this.current_values){if(asset!='seconds'&&!this.current_values[asset]!=!result[asset]){this.initDisplay=!0;break}}
return result;function dateToObject(date){return{year:date.getUTCFullYear(),month:date.getUTCMonth()+1,day:date.getUTCDate(),hours:date.getUTCHours(),minutes:date.getUTCMinutes(),seconds:date.getUTCSeconds()}}
function daysInThisMonth(year,month){if(month==12){year++;month=0}
return new Date(Date.UTC(year,month,0)).getUTCDate()}
function daysInPrevMonth(year,month){month=month-2;if(month<0){year--}
return new Date(Date.UTC(year,month+1,0)).getUTCDate()}},updateCounter:function(new_values,mode_changed){if(mode_changed===!0){$('#'+this.options.id+' .scd-digit').remove();this.elements={}}
this.display(new_values,mode_changed);this.displayTexts()},display:function(new_values,mode_changed){var prev,next;if(typeof this.current_values.seconds==='undefined'){this.initDisplay=!0;this.current_values=new_values}
if(this.initDisplay){for(key in this.animation_timers){window.clearTimeout(this.animation_timers[key])}
this.animation_timers={}}
prev=this.current_values;next=new_values;var i,self=this,updateUnitsWidth=!1;$.each(this.options.units,function(asset,display){if(display==0||(!self.initDisplay&&!mode_changed&&next[asset]==prev[asset])){return}
if(self.updateCounterUnit(asset,prev[asset],next[asset],self.initDisplay)===!0){updateUnitsWidth=!0}});if(updateUnitsWidth){this.setRowVerticalAlign();this.responsiveAdjust()}
if(this.initDisplay||(this.options.mode=='down'&&next.seconds==this.options.limits.seconds-1)||(this.options.mode=='up'&&next.seconds==0)){this.setCounterUnitsVisibility(next)}
this.initDisplay=!1;this.current_values=new_values},displayTexts:function(){if(this.options.mode=='up'){$('#'+this.options.id+'-title-before').html(this.options.title_before_up);$('#'+this.options.id+'-title-after').html(this.options.title_after_up)}else{$('#'+this.options.id+'-title-before').html(this.options.title_before_down);$('#'+this.options.id+'-title-after').html(this.options.title_after_down)}},updateCounterUnit:function(asset,old_value,new_value,initDisplay){old_value=this.padLeft(old_value,this.options.paddings[asset]);new_value=this.padLeft(new_value,this.options.paddings[asset]);$('#'+this.options.id+'-'+asset+'-label').text(this.getLabel(asset,new_value));var wrapper=$('#'+this.options.id+'-'+asset+'-digits'),count=wrapper.children('.scd-digit').length;var updateDigitsWidth=!1,new_digits;if(new_value.length!=count){new_digits=this.updateDigitsCount(asset,count,old_value,new_value,wrapper);old_value=new_digits.old_value;new_value=new_digits.new_value;updateDigitsWidth=!0}
var values={'prev':old_value.split(''),'next':new_value.split('')};for(i=0;i<values.next.length;i++){if(values.prev[i]!=values.next[i]||initDisplay){this.updateCounterDigit(asset,$(wrapper).children('.scd-digit').eq(i),values.next.length-i-1,values.prev[i],values.next[i],old_value,new_value,initDisplay)}}
return updateDigitsWidth},padLeft:function(value,len){value=value+'';if(value.length<len){value=Array(len+1-value.length).join('0')+value}
return value},updateDigitsCount:function(asset,current_count,old_value,new_value,wrapper){var i;if(new_value.length<current_count){for(i=current_count-1;i>=new_value.length;i--){delete(this.elements[asset+i]);wrapper.children('.scd-digit').first().remove()}
old_value=old_value.slice(old_value.length-new_value.length);return{old_value:old_value,new_value:new_value}}else{var new_digit,guess_prev_value,config_index,config;var digits_to_add=new_value.slice(0,new_value.length-current_count);digits_to_add=digits_to_add.split('').reverse().join('');old_value=this.padLeft(old_value,new_value.length);var digits_from=old_value.slice(0,old_value.length-current_count);digits_from=digits_from.split('').reverse().join('');for(i=0;i<digits_to_add.length;i++){new_digit=$('<div class="scd-digit"></div>');wrapper.prepend(new_digit);guess_prev_value=current_count==0?digits_from[i]:'0';config_index=(i+current_count==0&&asset=='seconds'?0:asset+(i+current_count));config=typeof this.options.animations.digits[config_index]==='undefined'?this.options.animations.digits['*']:this.options.animations.digits[config_index];this.setElements(new_digit,{'prev':guess_prev_value,'next':digits_to_add[i]},asset+(i+current_count),config)}
old_value=this.padLeft(old_value,new_value.length);return{old_value:old_value,new_value:new_value}}},updateCounterDigit:function(asset,wrapper,index,old_digit,new_digit,old_unit_value,new_unit_value,initDisplay){var hash_prefix=asset+index;var values={'prev':old_digit,'next':new_digit}
if(this.options.animations.uses_margin_values==1){if(this.options.mode=='down'){values['pre-prev']=this.guessIncrValue(asset,index,old_digit,old_unit_value);values['post-next']=this.guessDecrValue(asset,index,new_digit,new_unit_value)}else{values['pre-prev']=this.guessDecrValue(asset,index,old_digit,old_unit_value);values['post-next']=this.guessIncrValue(asset,index,new_digit,new_unit_value)}
if(initDisplay){values.prev=values['pre-prev']}}
var config_index=(index==0&&asset=='seconds'?0:asset+index);var config=typeof this.options.animations.digits[config_index]==='undefined'?this.options.animations.digits['*']:this.options.animations.digits[config_index];var groups=config[this.options.mode];if(initDisplay){this.setElements(wrapper,values,hash_prefix,config)}
if(values.prev!=values.next){this.animateElements(values,hash_prefix,groups)}},guessIncrValue:function(asset,index,digit_value,unit_value){var limit=this.guessDigitLimit(asset,index,digit_value,unit_value);if(++digit_value>limit){digit_value=0}
return digit_value},guessDecrValue:function(asset,index,digit_value,unit_value){var limit=this.guessDigitLimit(asset,index,digit_value,unit_value);if(--digit_value<0){digit_value=limit}
return digit_value},guessDigitLimit:function(asset,index,digit_value,unit_value){var limit=9;if(asset=='seconds'){if(this.options.units.minutes==1){if(index!=0){limit=5}}}else if(asset=='minutes'){if(this.options.units.hours==1){if(index!=0){limit=5}}}else if(asset=='hours'&&this.options.units.days==1){if(index==1){limit=2}else if(index==0&&unit_value>=20){limit=3}}
return limit},setElements:function(wrapper,values,prefix,config){wrapper.empty();this.elements[prefix]={};wrapper.css(config.style);var groups=config[this.options.mode];var i,group;for(i=0;i<groups.length;i++){group=groups[i];var els=group.elements,j,el,$el,hash;for(j=0;j<els.length;j++){el=els[j];hash=this.getElementHash(el);$el=this.createElement(el,values);if(el.content_type=='static-bg'){$el.attr('src',this.options.animations.images_folder+el.filename_base+el.filename_ext)}
if(typeof this.elements[prefix][hash]==='undefined'){this.elements[prefix][hash]=$el}}}
$.each(this.elements[prefix],function(hash,el){wrapper.append(el)})},animateElements:function(values,prefix,groups){var i,group;for(i=0;i<groups.length;i++){group=groups[i];var j,el,$el,value;for(j=0;j<group.elements.length;j++){el=group.elements[j];if(el.content_type=='static-bg'){continue}
$el=this.elements[prefix][this.getElementHash(el)];$el.css(el.styles)}}
this.animateGroup(values,0,prefix,groups)},animateGroup:function(values,group_index,prefix,groups){if(group_index>=groups.length){return}
var i,group=groups[group_index],el,$el,styles,self=this;var duration=this.initDisplay?0:+group.duration;var transition=group.transition;var elements_count=group.elements.length,cur_element_index=0,group_processed=!1;for(i=0;i<group.elements.length;i++){el=group.elements[i];if(el.content_type=='static-bg'){elements_count--;continue}
$el=this.elements[prefix][this.getElementHash(el)];$el.css(el.tweens.from);value=el.content_type=='uni-img'?'':values[el.value_type];if(el.content_type=='txt'){$el.text(value)}else{var src=this.options.animations.images_folder+el.filename_base+value+el.filename_ext;$el.attr('src',src)}
group_processed=!0;if(el.tweens.to.length===0){if(duration>0){this.animation_timers[prefix+group_index]=window.setTimeout(function(){cur_element_index++;if(cur_element_index>=elements_count){self.animateGroup(values,group_index+1,prefix,groups)}},duration)}else{cur_element_index++;if(cur_element_index>=elements_count){this.animateGroup(values,group_index+1,prefix,groups)}}}else{$el.velocity('stop');$el.velocity(el.tweens.to,duration,transition,function(){cur_element_index++;if(cur_element_index>=elements_count){self.animateGroup(values,group_index+1,prefix,groups)}})}}
if(!group_processed){this.animation_timers[prefix+group_index]=window.setTimeout(function(){self.animateGroup(values,group_index+1,prefix,groups)},duration)}},getElementHash:function(el){return[el.content_type,el.value_type,el.filename_base,el.filename_ext].join('::')},createElement:function(el,values){var $el;if(el.content_type=='txt'){$el=$('<'+el.tag+'/>');$el.text(values[el.value_type])}else{var value=el.content_type=='img'?values[el.value_type]:'',src;src=this.options.animations.images_folder+el.filename_base+value+el.filename_ext;$el=$('<'+el.tag+'/>');$el.attr('src',src)}
$el.css(el.styles);return $el},getLabel:function(asset,value){var labels={years:'Y',months:'M',weeks:'W',days:'D',hours:'H',minutes:'Min',seconds:'Sec'};var suffix=smartcountdown_plural(value);return smartcountdownstrings[asset+suffix]||labels[asset];return labels[asset]},setCounterUnitsVisibility:function(new_values){var hide_units=$.extend([],this.options.hide_lower_units);var i,assets=['years','months','weeks','days','hours','minutes','seconds'];if(this.options.allow_all_zeros==0&&$.inArray('seconds',hide_units)!=-1){var index;var lowest_displayed_unit=-1,is_non_zero=0;for(i=0;i<assets.length;i++){index=$.inArray(assets[i],hide_units);if(index==-1){is_non_zero=is_non_zero+(new_values[assets[i]]||0);lowest_displayed_unit=i}}
if(!is_non_zero&&lowest_displayed_unit>=0&&new_values[assets[lowest_displayed_unit]]==0){for(i=lowest_displayed_unit;i<assets.length;i++){if(new_values[assets[i]]>0||assets[i]=='seconds'){index=$.inArray(assets[i],hide_units);if(index>-1){hide_units.splice(index,1);if(this.options.replace_lowest_zero==1){hide_units.push(assets[lowest_displayed_unit])}
break}}}}}
if(this.options.hide_highest_zeros==1){var lowest_displayed_unit=-1;for(i=0;i<assets.length;i++){if(this.options.units[assets[i]]==0){continue}
lowest_displayed_unit=i;if((new_values[assets[i]]||0)==0){if($.inArray(assets[i],hide_units)==-1){hide_units.push(assets[i])}}else{break}}
if(lowest_displayed_unit>-1&&new_values[assets[lowest_displayed_unit]]==0){hide_units.splice(lowest_displayed_unit,1)}
var visible_unit_found=!1;$.each(this.options.units,function(asset,display){if(display&&$.inArray(asset,hide_units)==-1){visible_unit_found=!0;return!1}});if(!visible_unit_found){hide_units.pop()}}
var unitsChanged=!1;var self=this;$.each(this.options.units,function(asset,display){var unit_wrapper=$('#'+self.options.id+'-'+asset);if(display==1&&$.inArray(asset,hide_units)==-1){if(!unit_wrapper.is(':visible')){unitsChanged=!0}
unit_wrapper.show()}else{if(unit_wrapper.is(':visible')){unitsChanged=!0}
unit_wrapper.hide()}});if(unitsChanged){this.setRowVerticalAlign();this.responsiveAdjust()}
var counter_container=$('#'+this.options.id);if(this.options.mode=='up'){if(this.options.hide_countup_counter==1){counter_container.find('.scd-counter').hide();counter_container.show()}else{counter_container.find('.scd-counter').show()}}else{counter_container.find('.scd-counter').show()}
if(this.options.click_url!=''){counter_container.css('cursor','pointer');counter_container.off('click');counter_container.on('click',function(){window.open(self.options.click_url,'_blank')})}else{counter_container.css('cursor','default');counter_container.off('click')}},applyCounterLimits:function(){var counter_container=$('#'+this.options.id);if(this.options.mode=='down'){if(this.options.countdown_limit>=0&&this.diff>=this.options.countdown_limit*MILLIS_IN_SECOND){counter_container.hide()}else{counter_container.show()}
if(this.options.countdown_query_limit>0&&this.diff<this.options.countdown_query_limit*MILLIS_IN_SECOND){this.queryNextEvent();this.options.countup_limit=-1}}
if(this.options.mode=='up'){if(this.options.countup_limit>=0&&this.diff>=this.options.countup_limit*MILLIS_IN_SECOND){this.queryNextEvent();this.options.countup_limit=-1}}},setRowVerticalAlign:function(){if(typeof this.label_min_widths==='undefined'){if(this.updateMinLabelsWidth()===!1){return}}
var digits=$('#'+this.options.id+' .scd-unit-vert .scd-digits-row:visible');if(digits.length>0){var maxWidth=0,width;digits.css('min-width','');digits.each(function(){width=$(this).width();if(width>maxWidth){maxWidth=width}});digits.css('min-width',maxWidth)}
var labels=$('#'+this.options.id+' .scd-unit-vert .scd-label-row:visible');labels.css('min-width',this.labels_max_width+'em');labels=$('#'+this.options.id+' .scd-unit-horz .scd-label:visible');if(labels.length>0){var self=this;labels.each(function(){var $this=$(this);width=$this.width();if($this.hasClass('scd-label-col')){$this.css('min-width',self.labels_max_width+'em')}else{$this.css('min-width',self.label_min_widths[$this.attr('id')]+'em')}})}
this.setLabelsPosition();if(this.options.hide_countup_counter!=1||this.options.mode!='up'){$('#'+this.options.id).find('.scd-counter-col').css('display','inline-block')}},updateMinLabelsWidth:function(){var test_label=$('#'+this.options.id+' .scd-label:visible').first(),unit,label_id,width,max_width=0;if(test_label.length==0){return!1}
var the_text=test_label.text();test_label.css('min-width','');this.label_min_widths={};for(label_key in smartcountdownstrings){unit=label_key.split('_',1)[0];if(!unit){unit=label_key}
label_id=this.options.id+'-'+unit+'-label';if(typeof this.label_min_widths[label_id]==='undefined'){this.label_min_widths[label_id]=0}
test_label.text(smartcountdownstrings[label_key]);width=test_label.width()/this.options.labels_size;if(this.label_min_widths[label_id]<width){this.label_min_widths[label_id]=width}
if(max_width<width){max_width=width}}
this.labels_max_width=max_width;test_label.text(the_text)},setLabelsPosition:function(){$('#'+this.options.id+' .scd-label-col:visible').css('position','');var labels=$('#'+this.options.id+' .scd-label-row:visible');if(labels.length>0){var digitsDiv,digitsHeight,labelHeight,top,self=this;labels.each(function(){var $this=$(this);digitsDiv=$this.siblings('.scd-digits-row');digitsHeight=digitsDiv.height();labelHeight=$this.height();var a=digitsDiv[0].getBoundingClientRect();var b=this.getBoundingClientRect();if(!(b.left>a.right||b.right<a.left||b.top>a.bottom||b.bottom<a.top)){$this.css('position','');$this.css('top','');return!0}
$this.css('position','relative');switch(self.options.labels_vert_align){case 'top':top=0;break;case 'bottom':top=digitsHeight-labelHeight;break;case 'high':top=labelHeight*0.5;break;case 'low':top=digitsHeight-labelHeight*1.5;break;case 'superscript':top=labelHeight*-0.5;break;case 'subscript':top=digitsHeight-labelHeight/2;break;default:top=digitsHeight/2-labelHeight/2}
$this.css('top',top)})}},resetAlignments:function(counter_container){counter_container.find('.scd-label').css({position:'',top:''});counter_container.find('.scd-label, .scd-digits').css('min-width','')},responsiveAdjust:function(){var responsive=this.options.responsive;var counter_container=$('#'+this.options.id),i,scale=1.0,self=this;var height=counter_container.height();counter_container.css('height',height);if(responsive&&responsive.length>0){this.resetAlignments(counter_container);counter_container.css('font-size',this.options.base_font_size+'px');var scale_preset=responsive[responsive.length-1];this.applyLayout(counter_container,scale_preset.alt_classes);this.setRowVerticalAlign();var is_wrapping=this.checkWrapping(counter_container.find('.scd-unit-horz:visible, .scd-title-row'));if(is_wrapping.wrapped_width>0){var container_width=counter_container.width();var required_width=is_wrapping.row_width+is_wrapping.wrapped_width+SCD_SAFE_ADJUST_PX;scale=container_width/required_width}
var digit_groups=counter_container.find('.scd-digits:visible'),is_wrapped=!1;digit_groups.each(function(){var $this=$(this);var is_wrapping=self.checkWrapping($this.find('.scd-digit'));if(is_wrapping.wrapped_width>0){var container_width=$this.width();var required_width=is_wrapping.row_width+is_wrapping.wrapped_width+SCD_SAFE_ADJUST_PX;var this_scale=container_width/required_width;if(this_scale<scale){scale=this_scale}
is_wrapped=!0}});for(i=0;i<responsive.length;i++){var scale_preset=responsive[i];if(scale<=scale_preset.scale){this.applyLayout(counter_container,scale_preset.alt_classes);break}}
scale=1.0;counter_container.css('font-size',this.options.base_font_size+'px');this.setRowVerticalAlign();var is_wrapping=this.checkWrapping(counter_container.find('.scd-unit-horz:visible, .scd-title-row'));if(is_wrapping.wrapped_width>0){var container_width=counter_container.width();var required_width=is_wrapping.row_width+is_wrapping.wrapped_width+SCD_SAFE_ADJUST_PX;scale=container_width/required_width;counter_container.css('font-size',(this.options.base_font_size*scale)+'px');this.setRowVerticalAlign()}}else{counter_container.css('font-size',this.options.base_font_size+'px')}
var digit_groups=counter_container.find('.scd-digits:visible'),is_wrapped=!1;digit_groups.each(function(){var $this=$(this);var is_wrapping=self.checkWrapping($this.find('.scd-digit'));if(is_wrapping.wrapped_width>0){var container_width=$this.width();var required_width=is_wrapping.row_width+is_wrapping.wrapped_width+SCD_SAFE_ADJUST_PX;var this_scale=container_width/required_width;if(this_scale<scale){scale=this_scale}
is_wrapped=!0}});if(is_wrapped){counter_container.css('font-size',(this.options.base_font_size*scale)+'px')}
this.setRowVerticalAlign();counter_container.css('height','')},checkWrapping:function(units){var row_width=0,wrapped_width=0,top=null;units.each(function(){var $this=$(this),unit_position=$this.position();if(top===null){top=unit_position.top}
if(top!=unit_position.top){wrapped_width+=$this.outerWidth(!0)}else{row_width+=$this.outerWidth(!0)}});return{row_width:row_width,wrapped_width:wrapped_width}},applyLayout:function(counter_container,alt_classes){if(alt_classes.length>0){$.each(alt_classes,function(index,classes){if($.isArray(classes)){$.each(classes,function(ci,c){counter_container.find(c.selector).removeClass(c.remove).addClass(c.add)})}else{counter_container.find(classes.selector).removeClass(classes.remove).addClass(classes.add)}})}},queryNextEvent:function(isNew){var self=this;$('#'+self.options.id+'-loading').show();$('#'+self.options.id+' .scd-all-wrapper').hide();var queryData={action:'scd_query_next_event',smartcountdown_nonce:smartcountdownajax.nonce,unique_ts:new Date().getTime()};if(this.options.shortcode==1){queryData.deadline=this.options.original_deadline;queryData.import_config=this.options.import_config;queryData.countdown_to_end=this.options.countdown_to_end;queryData.countup_limit=this.options.original_countup_limit}else{queryData.id=this.options.id;if(this.options.customize_preview==1){queryData.customize_preview=1;queryData.deadline=this.options.original_deadline;queryData.import_config=this.options.import_config||'';queryData.countdown_to_end=this.options.countdown_to_end;queryData.countdown_limit=this.options.countdown_limit;queryData.countup_limit=this.options.original_countup_limit}}
$.getJSON(smartcountdownajax.url,queryData,function(response){$('#'+self.options.id+'-loading').hide();$('#'+self.options.id+' .scd-all-wrapper').show();if(response.err_code==0){self.options.deadline=response.options.deadline;self.options.title_before_down=self.options.original_title_before_down;self.options.title_after_down=self.options.original_title_after_down;if(typeof response.options.imported_title!=='undefined'){if(self.options.original_title_before_down!=''){if(self.options.original_title_before_down.indexOf('%imported%')!=-1){self.options.title_before_down=self.options.original_title_before_down.replace('%imported%',response.options.imported_title)}else{self.options.title_before_down=self.options.original_title_before_down+' '+response.options.imported_title}}else{self.options.title_before_down=response.options.imported_title}
if(self.options.original_title_before_up!=''){if(self.options.original_title_before_up.indexOf('%imported%')!=-1){self.options.title_before_up=self.options.original_title_before_up.replace('%imported%',response.options.imported_title)}else{self.options.title_before_up=self.options.original_title_before_up+' '+response.options.imported_title}}else{self.options.title_before_up=response.options.imported_title}}else{self.options.title_before_down=self.options.original_title_before_down.replace('%imported%','');self.options.title_before_up=self.options.original_title_before_up.replace('%imported%','')}
if(response.options.is_countdown_to_end==1){self.options.title_before_down=self.options.title_before_up;self.options.title_after_down=self.options.title_after_up;self.options.countdown_limit=-1}
self.options.countup_limit=response.options.countup_limit;self.options.countdown_query_limit=response.options.countdown_query_limit;if(response.options.deadline==''){scds_container.remove(self.options.id);$('#'+self.options.id).hide();return}
self.options.deadline=new Date(self.tsFromISO(self.options.deadline)).toString();scds_container.setServerTime(response.options.now);self.updateCounter(self.getCounterValues());self.applyCounterLimits();if(isNew){scds_container.updateInstance(self.options.id,self)}else if(self.options.redirect_url!=''&&self.options.mode=='up'){$('#'+self.options.id).hide();window.location=self.options.redirect_url}
self.setCounterUnitsVisibility(self.current_values)}else{}}).fail(function(jqxhr,textStatus,error){$('#'+self.options.id+'-loading').hide();$('#'+self.options.id+' .scd-all-wrapper').show()})},tsFromISO:function(s){var D=new Date(s);if(isNaN(D.getTime())){var day,tz,rx=/^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/,p=rx.exec(s)||[];if(p[1]){day=p[1].split(/\D/);for(var i=0,L=day.length;i<L;i++){day[i]=parseInt(day[i],10)||0};day[1]-=1;day=new Date(Date.UTC.apply(Date,day));if(!day.getDate())return NaN;if(p[5]){tz=(parseInt(p[5],10)*60);if(p[6])tz+=parseInt(p[6],10);if(p[4]=='+')tz*=-1;if(tz)day.setUTCMinutes(day.getUTCMinutes()+tz)}
return day.getTime()}
return NaN}else{return D.getTime()}}}})(jQuery)